{% extends "base.html" %}

{% block extrahead %}
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="{{ base_url }}/search/main.js" defer></script>
{% endblock %}

{% block content %}
<a href="#main-content" class="skip-link">Skip to Content</a>

<nav class="navbar-hardened">
    <a href="{{ nav.homepage.url|url }}" class="font-extrabold text-2xl shrink-0" style="color:var(--text-main)">
        <i class="fas fa-book-open"></i> OI <span style="color:var(--oi-primary)">DOCS</span>
    </a>

    <div class="header-search-wrap">
        <form role="search" onsubmit="return false;">
            <label for="mkdocs-search-query" class="sr-only">Search</label>
            <input type="text" id="mkdocs-search-query" class="header-search-input"
                   placeholder="Search docs..." autocomplete="off">
        </form>
        <div id="mkdocs-search-results" class="search-results"></div>
    </div>

    <div class="flex gap-3 shrink-0">
        <a href="https://n00b-5634.github.io/OpenIndiana-SiteReimagined/"
           class="icon-btn px-4 py-2 border-2 rounded-xl font-bold text-[10px] uppercase flex items-center"
           style="border-color:var(--card-border); color:var(--text-main);">
            <i class="fas fa-home"></i> Go to main page
        </a>
        <button id="a11y-toggle" class="icon-btn px-3 py-1.5 border-2 rounded-lg font-bold text-[9px] uppercase opacity-60 hover:opacity-100" style="border-color:var(--card-border)">
            <i class="fas fa-universal-access"></i> W3C Access
        </button>
        <button id="master-theme-toggle" class="icon-btn px-4 py-2 border-2 rounded-xl font-bold text-[10px] uppercase" style="border-color:var(--card-border)">
            <i class="fas fa-moon"></i> DARK MODE
        </button>
    </div>
</nav>

{% if page.is_homepage %}
<header class="hero-banner">
    <h1 class="hero-title">Welcome to oi-docs reimagined</h1>
    <p class="hero-subtitle">Your secondary source for OpenIndiana resources.</p>
</header>
<main id="main-content" class="markdown-engine">
    {{ page.content }}
</main>
{% else %}
<div class="documentation-container">
    <aside class="sidebar-nav">
        <p class="nav-section-title">Navigation</p>
        <a href="/site_docs" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Home
        </a>
        <a href="/site_docs/books/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Books
        </a>
        <a href="/site_docs/community_hcl/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Community hcl
        </a>
        <a href="/site_docs/contrib/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Contrib
        </a>
        <a href="/site_docs/dev/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Dev
        </a>
        <a href="/site_docs/handbook/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Handbook
        </a>
        <a href="/site_docs/misc/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Misc
        </a>
        <a href="/site_docs/release-notes/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Release notes
        </a>
        <a href="/site_docs/retired/" class="block mb-4 text-sm font-bold no-underline hover:text-[var(--oi-primary)] text-[var(--text-main)]">
            <i class="fas fa-file-alt mr-2"></i> Retired
        </a>
    </aside>
    <main id="main-content" class="documentation-wrapper markdown-engine">
        <article>{{ page.content }}</article>
    </main>
</div>
{% endif %}

<footer class="custom-footer">
    <div class="flex justify-center gap-8 opacity-80">
        <a href="https://n00b-5634.github.io/OpenIndiana-SiteReimagined" class="hover:underline"><i class="fas fa-globe mr-1"></i> Website</a>
        <a href="https://github.com/N00B-5634/OpenIndiana-SiteReimagined" class="hover:underline"><i class="fab fa-github mr-1"></i> GitHub</a>
    </div>
</footer>

<script>
(function() {
    const toggle = document.getElementById('master-theme-toggle');
    const a11yBtn = document.getElementById('a11y-toggle');
    const html = document.documentElement;

    a11yBtn.addEventListener('click', () => {
        html.classList.toggle('a11y-mode');
        a11yBtn.textContent = html.classList.contains('a11y-mode') ? "Standard Mode" : "W3C Access";
        a11yBtn.innerHTML = html.classList.contains('a11y-mode')
            ? '<i class="fas fa-ban"></i> Standard Mode'
            : '<i class="fas fa-universal-access"></i> W3C Access';
    });

    const applyTheme = (theme) => {
        if (theme === 'dark') {
            html.setAttribute('data-theme', 'dark');
            toggle.innerHTML = '<i class="fas fa-sun"></i> LIGHT MODE';
        } else {
            html.removeAttribute('data-theme');
            toggle.innerHTML = '<i class="fas fa-moon"></i> DARK MODE';
        }
        localStorage.setItem('oi-theme-v5', theme);
    };
    applyTheme(localStorage.getItem('oi-theme-v5') || 'light');
    toggle.addEventListener('click', () => applyTheme(html.hasAttribute('data-theme') ? 'light' : 'dark'));
})();

// Initialize MkDocs search on page load
document.addEventListener('DOMContentLoaded', function() {
    if (typeof MkDocsSearch !== 'undefined') {
        new MkDocsSearch({
            inputSelector: '#mkdocs-search-query',
            resultContainerSelector: '#mkdocs-search-results',
            jsonDataUrl: 'search_index.json',
        });
    }
    // Show/hide search results
    const searchInput = document.getElementById('mkdocs-search-query');
    const searchResults = document.getElementById('mkdocs-search-results');
    searchInput.addEventListener('focus', () => {
        searchResults.style.display = 'block';
    });
    searchInput.addEventListener('blur', () => {
        setTimeout(() => {
            searchResults.style.display = 'none';
        }, 200);
    });

    // Highlight current page in navigation
    const navLinks = document.querySelectorAll('.sidebar-nav a');
    const currentPath = window.location.pathname;
    navLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('text-[var(--oi-primary)]');
        }
    });
});
</script>
{% endblock %}
