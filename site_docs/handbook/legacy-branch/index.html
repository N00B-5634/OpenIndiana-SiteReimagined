<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://n00b-5634.github.io/OpenIndiana-SiteReimagined/handbook/legacy-branch/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Legacy branch - OpenIndiana Reimagined</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../css/style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    <script src="https://cdn.tailwindcss.com"></script>

    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">OpenIndiana Reimagined</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Welcome to OpenIndiana Reimagined</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Books <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../books/about/" class="dropdown-item">About</a>
</li>
                                    
<li>
    <a href="../../books/advanced/" class="dropdown-item">Advanced</a>
</li>
                                    
<li>
    <a href="../../books/basic/" class="dropdown-item">Basic</a>
</li>
                                    
<li>
    <a href="../../books/develop/" class="dropdown-item">Develop</a>
</li>
                                    
<li>
    <a href="../../books/express/" class="dropdown-item">Express</a>
</li>
                                    
<li>
    <a href="../../books/trusted/" class="dropdown-item">Trusted</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Community hcl <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../community-hcl/components/" class="dropdown-item">Components</a>
</li>
                                    
<li>
    <a href="../../community-hcl/getting-hardware-info/" class="dropdown-item">Getting hardware info</a>
</li>
                                    
<li>
    <a href="../../community-hcl/systems/" class="dropdown-item">Systems</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Contrib <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../contrib/content/" class="dropdown-item">Content</a>
</li>
                                    
<li>
    <a href="../../contrib/getting-started/" class="dropdown-item">Getting started</a>
</li>
                                    
<li>
    <a href="../../contrib/git/" class="dropdown-item">Git</a>
</li>
                                    
<li>
    <a href="../../contrib/markdown/" class="dropdown-item">Markdown</a>
</li>
                                    
<li>
    <a href="../../contrib/roles/" class="dropdown-item">Roles</a>
</li>
                                    
<li>
    <a href="../../contrib/style/" class="dropdown-item">Style</a>
</li>
                                    
<li>
    <a href="../../contrib/tools/" class="dropdown-item">Tools</a>
</li>
                                    
<li>
    <a href="../../contrib/topics/" class="dropdown-item">Topics</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Dev <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../dev/building-openindiana/" class="dropdown-item">Building openindiana</a>
</li>
                                    
<li>
    <a href="../../dev/distribution-constructor/" class="dropdown-item">Distribution constructor</a>
</li>
                                    
<li>
    <a href="../../dev/existing-tasks/" class="dropdown-item">Existing tasks</a>
</li>
                                    
<li>
    <a href="../../dev/graphics-stack/" class="dropdown-item">Graphics stack</a>
</li>
                                    
<li>
    <a href="../../dev/repo-cleanup/" class="dropdown-item">Repo cleanup</a>
</li>
                                    
<li>
    <a href="../../dev/userland/" class="dropdown-item">Userland</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Handbook <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../appendix/" class="dropdown-item">Appendix</a>
</li>
                                    
<li>
    <a href="../common-tasks/" class="dropdown-item">Common tasks</a>
</li>
                                    
<li>
    <a href="../community/" class="dropdown-item">Community</a>
</li>
                                    
<li>
    <a href="../getting-started/" class="dropdown-item">Getting started</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Legacy branch</a>
</li>
                                    
<li>
    <a href="../network-communications/" class="dropdown-item">Network communications</a>
</li>
                                    
<li>
    <a href="../openindiana-download-mirrors/" class="dropdown-item">Openindiana download mirrors</a>
</li>
                                    
<li>
    <a href="../pdfdocs/" class="dropdown-item">Pdfdocs</a>
</li>
                                    
<li>
    <a href="../sunray/" class="dropdown-item">Sunray</a>
</li>
                                    
<li>
    <a href="../systems-administration/" class="dropdown-item">Systems administration</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Community</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../community/inputmethod/" class="dropdown-item">Inputmethod</a>
</li>
            
<li>
    <a href="../community/oracledb/" class="dropdown-item">Oracledb</a>
</li>
            
<li>
    <a href="../community/quikstor/" class="dropdown-item">Quikstor</a>
</li>
            
<li>
    <a href="../community/samqfs/" class="dropdown-item">Samqfs</a>
</li>
            
<li>
    <a href="../community/squeak/" class="dropdown-item">Squeak</a>
</li>
            
<li>
    <a href="../community/texlive/" class="dropdown-item">Texlive</a>
</li>
            
<li>
    <a href="../community/vagrant/" class="dropdown-item">Vagrant</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Misc <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../misc/conduct/" class="dropdown-item">Conduct</a>
</li>
                                    
<li>
    <a href="../../misc/oi-docs/" class="dropdown-item">Oi docs</a>
</li>
                                    
<li>
    <a href="../../misc/openindiana/" class="dropdown-item">Openindiana</a>
</li>
                                    
<li>
    <a href="../../misc/pdl/" class="dropdown-item">PUBLIC DOCUMENTATION LICENSE</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Release notes <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../release-notes/2015.03-release-notes/" class="dropdown-item">2015.03 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2015.10-release-notes/" class="dropdown-item">2015.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2016.04-release-notes/" class="dropdown-item">2016.04 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2016.10-release-notes/" class="dropdown-item">2016.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2017.04-release-notes/" class="dropdown-item">2017.04 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2017.10-release-notes/" class="dropdown-item">2017.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2018.04-release-notes/" class="dropdown-item">2018.04 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2018.10-release-notes/" class="dropdown-item">2018.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2019.04-release-notes/" class="dropdown-item">2019.04 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2019.10-release-notes/" class="dropdown-item">2019.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2020.04-release-notes/" class="dropdown-item">2020.04 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/2020.10-release-notes/" class="dropdown-item">2020.10 release notes</a>
</li>
                                    
<li>
    <a href="../../release-notes/latest-changes/" class="dropdown-item">Latest changes</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Retired <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../retired/" class="dropdown-item">Index</a>
</li>
                                    
<li>
    <a href="../../retired/books/" class="dropdown-item">Books</a>
</li>
                                    
<li>
    <a href="../../retired/bsd/" class="dropdown-item">Bsd</a>
</li>
                                    
<li>
    <a href="../../retired/old-handbook/" class="dropdown-item">TODO: Booting</a>
</li>
                                    
<li>
    <a href="../../retired/project/" class="dropdown-item">Project</a>
</li>
                                    
<li>
    <a href="../../retired/sphinx/" class="dropdown-item">Sphinx</a>
</li>
                                    
<li>
    <a href="../../retired/toolchain/" class="dropdown-item">Toolchain</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../getting-started/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../network-communications/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
    <div class="bg-[#0f172a] text-slate-200 p-8 rounded-lg shadow-2xl border border-slate-800">
        <div class="prose prose-invert max-w-none">
            <!--

The contents of this Documentation are subject to the Public Documentation License Version 1.01
 (the "License"); you may only use this Documentation if you comply with the terms of this License.
A copy of the License is available at http://illumos.org/license/PDL.


The Original Documentation is _________________.

The Initial Writer of the Original Documentation is ___________ Copyright (C)_________[Insert year(s)].
All Rights Reserved. (Initial Writer contact(s):________________[Insert hyperlink/alias]).

Contributor(s):  Michael Kruger, Alexander Pyhalov

Portions created by Michael Kruger Copyright (C) 2016.
Portions created by Alexander Pyhalov are Copyright (C) 2019.

Portions created by ______ are Copyright (C)_________[Insert year(s)].
All Rights Reserved. (Contributor contact(s):________________[Insert hyperlink/alias]).

-->

<h1 id="installing-openindiana-dev-and-upgrading-to-hipster">Installing OpenIndiana /dev and upgrading to /hipster</h1>
<div class="caution" markdown="1">
!!! danger "Caution"
    This page contains legacy instructions for creating USB media which applied prior to OI 2016.10,
    and upgrade instructions for the legacy oi-dev-151x branch. **This page is not applicable to current versions of OI**.
</div>

<h2 id="creating-a-hipster-usb-drive-pre-201610-only">Creating a Hipster USB Drive <em>(pre 2016.10 only)</em></h2>
<p>There are two unique methods for creating bootable USB flash drives.
The method to use depends on the release date of the USB image you intend to write.</p>
<ul>
<li>Applies only to OpenIndiana releases up to and including the OpenIndiana Hipster 2016.04 release.</li>
<li>This includes the legacy oi-dev-151a series of OpenIndiana releases.</li>
</ul>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>USB flash drive - (2GB or larger).</li>
<li>Download the OpenIndiana USB installer image.</li>
</ul>
<div class="note" markdown="1">
!!! note
    * Header files are only required when writing a legacy image **AND** using the dd utility.
        * Header files are **NOT** required when writing current images.
        * For example: The Hipster 2016.10 release, does **NOT** require header files.
</div>

<ul>
<li>Download the appropriate OpenIndiana <a href="http://dlc.openindiana.org/isos/archive/1G.header&quot;">1G</a> or <a href="http://dlc.openindiana.org/isos/archive/2G.header">2G</a> header file<ul>
<li>There are 2 unique USB header files (1G and 2G).</li>
<li>Please ensure you have selected the correct file as the files are <strong>NOT</strong> interchangeable.<ul>
<li>The 1G.header is only suitable for use with the text installer (Command line console).</li>
<li>The 2G.header is only suitable for use with the live installer (Gnome desktop).</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="caution" markdown="1">
!!! danger "Caution"
    Failure to use the correct USB header file can result in the USB drive either failing to boot, or only partially booting.
</div>

<h3 id="bsdlinuxos-x">BSD/Linux/OS X</h3>
<p>In the command below, replace <code>X</code> with the appropriate letter for your USB device. At least on Linux and FreeBSD you can add <code>status=progress</code> operand to print basic transfer statistics, refer to <code>dd(1)</code> man page of your platform for more information.</p>
<pre><code># cat 1G.header image.usb | dd bs=1024k of=/dev/sdX
</code></pre>
<p>For live images larger than 1GB, use the following command instead.</p>
<pre><code># cat 2G.header image.usb | dd bs=1024k of=/dev/sdX
</code></pre>
<h3 id="illumossolaris">illumos/Solaris</h3>
<p>For illumos based distributions including OpenIndiana, a script <a href="https://raw.githubusercontent.com/OpenIndiana/slim_source/oi/hipster/usr/src/cmd/install-tools/usbcopy">(USBCOPY)</a> is available to copy the USB image onto a USB device.</p>
<p>Be sure to run as root or with SUDO as the script exits if not run with elevated permissions.</p>
<!-- had to specify java (other langs may work) to fix the formatting -->

<pre><code class="language-java"># ./usbcopy image.usb
Found the following USB devices:
0:    devices/dev/rdsk/c4t0d0p0    3.9 GB    USB    DISK 2.0       1.00
Enter the number of your choice: 0

WARNING: All data on your USB storage will be lost.
Are you sure you want to install to
USB DISK 2.0 1.00, 3900 MB at /dev/rdsk/c4t0d0p0 ?  (y/n) y
Copying and verifying image to USB device
Finished 1643 MB in 685 seconds (2.3MB/s)
0 block(s) re-written due to verification failure
Installing grub to USB device /dev/rdsk/c4t0d0s0
Completed copy to USB
#
</code></pre>
<h3 id="windows">Windows</h3>
<p>The <a href="http://devzone.sites.pid0.org/OpenSolaris/opensolaris-liveusb-creator">OpenSolaris Live USB Creator</a> is a small stand alone GUI utility suitable for creating an OpenIndiana bootable USB flash drive.</p>
<h2 id="updating-openindiana-dev-to-hipster">Updating OpenIndiana /dev to /hipster</h2>
<p>This section describes how to update your existing OpenIndiana /dev installation to OpenIndiana /hipster.</p>
<p>Note, that although direct updating from /dev to /hipster can be possible, it's not exhaustively tested.</p>
<p>There are several techniques which you can use to update your systems, including root pool installation from OpenIndiana ISO.
Complete reinstall also can be a decent option.</p>
<p>Further it's considered that you were warned and decided to do more-or-less direct update from /dev to /hipster.</p>
<div class="note" markdown="1">
!!! note
    Only server installation update was tested.
    If you do GUI installation update, you are on your own.
    Of course, you are welcome to ask questions in [oi-dev](https://openindiana.org/mailman/listinfo/oi-dev) mailing list, but prepare that nobody will guide you through update.
</div>

<ul>
<li>
<p>Do backup.
  <br/>Seriously.
  The next steps can make your system unbootable.</p>
</li>
<li>
<p>Read release notes.
  <br/>Read release notes for ALL OpenIndiana Hipster snapshots.
  They contain information on system changes and possible troubles which can appear.
  Read <a href="https://www.openindiana.org/2016/09/28/loader-integration/">Loader Integration</a></p>
</li>
<li>
<p>Test your actions in non-production environment.
  <br/>Consider that last significant OpenIndiana /dev update was many years ago.
  You are going to update your applications perhaps via several major releases.
  Prepare for the changes.</p>
</li>
<li>
<p>You'll need console access to the server.
  <br/>Without console access and ability to boot fresh OpenIndiana Hipster ISO image, you'll not be able to activate new boot environment: old tools can't work with new facilities, new tools will not work with old kernel.</p>
</li>
<li>
<p>Update to the latest OpenIndiana /dev version.</p>
</li>
</ul>
<pre><code># pkg update -v
</code></pre>
<ul>
<li>Create new boot environment, which you'll update to /hipster, and mount it to <code>/mnt</code> (the default empty temporary mountpoint directory).</li>
</ul>
<pre><code class="language-bash"># beadm create oi-hipster
# beadm mount oi-hipster /mnt
</code></pre>
<ul>
<li>Uninstall all packages coming from opensolaris.org, sfe or sfe-encumbered publishers.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt list pkg://sfe/* pkg://sfe-encumbered/* pkg://opensolaris.org/*
# pkg -R /mnt uninstall &lt;list of matched packages&gt;
</code></pre>
<ul>
<li>Unset sfe, sfe-encumbered, opensolaris.org publishers in new BE if they were used.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt unset-publisher opensolaris.org
...
</code></pre>
<ul>
<li>Change publisher to <a href="http://pkg.openindiana.org/hipster">http://pkg.openindiana.org/hipster</a>.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt set-publisher -g http://pkg.openindiana.org/hipster -G http://pkg.openindiana.org/dev openindiana.org
</code></pre>
<ul>
<li>Refresh IPS catalog.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt refresh --full
</code></pre>
<div class="note" markdown="1">
!!! note
    Two following steps are actually better to run under `screen(1)` or `tmux(1)`
</div>

<ul>
<li>Look what IPS is going to do.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt update -nv 2&gt;&amp;1 | tee /root/testing_update
# less /root/testing_update
</code></pre>
<ul>
<li>If you are satisfied with what you've seen, run actual update and review <code>pkg(1)</code> output.</li>
</ul>
<pre><code class="language-bash"># pkg -R /mnt update -v 2&gt;&amp;1 | tee /root/update
# less /root/update
</code></pre>
<ul>
<li>Now you have updated boot environment, but have no means to activate it, so you'll have to boot from recent OpenIndiana minimal ISO.
  <br/>After booting from ISO run shell, import pool, update boot archive, install boot loader, activate new boot environment and reboot.
  <code>c2t0d0s0</code> disk name is used in example, you should look at <code>zpool status</code> output and use corresponding device.
  You'd better use cpio boot archive format due to existing issue in compressed ufs boot archive support.</li>
</ul>
<pre><code class="language-bash"># zpool import -R /tmp rpool
# beadm mount oi-hipster /mnt
# bootadm update-archive -R /mnt/tmp -vf -F cpio
# installboot -mvF  /mnt/tmp/boot/pmbr /mnt/tmp/boot/gptzfsboot /dev/rdsk/c2t0d0s0
# beadm activate oi-hipster
# init 6
</code></pre>
<ul>
<li>When your new boot environment is booting, look at possible error messages.
  <br/>You can see warnings about inability to import some manifests.
  After logging in you'll be able to import them manually with svccfg import.
  Also you'll have to remove metainit service, which has gone with SVM support.</li>
</ul>
<pre><code class="language-bash"># svccfg -s metainit delete default
</code></pre>
<ul>
<li>Look if there are any failed services and examine their log files.</li>
</ul>
<pre><code class="language-bash"># svcs -xv
</code></pre>
<ul>
<li>Ensure that you have latest osnet-incorporation and userland-incorporation installed.</li>
</ul>
<pre><code class="language-bash"># pkg info osnet-incorporation userland-incorporation
</code></pre>
        </div>
    </div>

            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
